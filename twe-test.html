<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>twe-test</title>
<style>
  body {
    margin: 0;
    background: #000;
    color: #ff1500;
    font-family: 'ZCOOL QingKe HuangYou', cursive;
    text-align: center;
  }
  #logo { width: 70%; max-width: 100%; margin: 20px auto; display: block; }

  .game-container { display: none; margin: 0 auto; }
  canvas { display: block; margin: 0 auto; background: #231F20; }

  #twegallery-container canvas { width: 80%; height: auto; aspect-ratio: 16/9; }
  #Mtwegallery-container canvas { width: 90%; height: auto; aspect-ratio: 9/16; }
</style>
</head>
<body>

<img id="logo" src="twegall-logo.png" alt="Logo">

<!-- Desktop Game -->
<div id="twegallery-container" class="game-container">
  <canvas id="twegallery-canvas"></canvas>
</div>

<!-- Mobile Game -->
<div id="Mtwegallery-container" class="game-container">
  <canvas id="Mtwegallery-canvas"></canvas>
</div>

<script>
let unityInstance = null;
let currentPlatform = null; // "desktop" or "mobile"

// simple Unity init function
function initUnity(canvasId, loaderUrl, dataUrl, frameworkUrl, codeUrl, productName) {
    return new Promise(resolve => {
        const canvas = document.getElementById(canvasId);
        const loaderScript = document.createElement("script");
        loaderScript.src = loaderUrl;
        loaderScript.onload = () => {
            createUnityInstance(canvas, {
                dataUrl: dataUrl,
                frameworkUrl: frameworkUrl,
                codeUrl: codeUrl,
                streamingAssetsUrl: "StreamingAssets",
                companyName: "DefaultCompany",
                productName: productName,
                productVersion: "0.1"
            }).then(instance => {
                unityInstance = instance;
                resolve();
            });
        };
        document.body.appendChild(loaderScript);
    });
}

// unload Unity instance
function unloadUnity() {
    if (unityInstance) {
        unityInstance.Quit();
        unityInstance = null;
    }
}

// check screen width and show appropriate game
function checkScreen() {
    const width = window.innerWidth;

    if(width > 768){
        // DESKTOP
        document.getElementById("twegallery-container").style.display = "block";
        document.getElementById("Mtwegallery-container").style.display = "none";

        if(currentPlatform !== "desktop"){
            unloadUnity();
            initUnity(
                "twegallery-canvas",
                "twegallery.loader.js",
                "twegallery.data",
                "twegallery.framework.js",
                "twegallery.wasm",
                "twegallery"
            );
            currentPlatform = "desktop";
        }
    } else {
        // MOBILE
        document.getElementById("twegallery-container").style.display = "none";
        document.getElementById("Mtwegallery-container").style.display = "block";

        if(currentPlatform !== "mobile"){
            unloadUnity();
            initUnity(
                "Mtwegallery-canvas",
                "Mtwegallery.loader.js",
                "Mtwegallery.data",
                "Mtwegallery.framework.js",
                "Mtwegallery.wasm",
                "Mtwegallery"
            );
            currentPlatform = "mobile";
        }
    }
}

// initial check + resize listener
checkScreen();
window.addEventListener("resize", checkScreen);
</script>

</body>
</html>
